<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<!-- <link rel="shortcut icon" href="/img/logo.png"> -->
<link rel='stylesheet' href='static/w3.css'>
<link rel='stylesheet' href='static/style.css'>
<script src='static/spagui_main.js'></script>
<script src='static/react.development.js'></script>
<script src='static/react-dom.development.js'></script>
<script src='static/babel.min.js'></script>
<title>sPAGUI3</title>
</head>
<body>
<div id='console_div' class='console_div_outside' hidden>
    <span id='cmsg' hidden class='console_message'></span>
</div>

<sidebar class='spagui-sidebar'>
    <div id='sidebar-sink-div'>
        <button class='w3-button spagui-bar-item'>Sinks</button>
        <div id='sidebar-sink-subdiv'></div>
    </div>

    <div id='sidebar-input-div'>
        <button class='w3-button spagui-bar-item'>Inputs</button>
        <div id='sidebar-input-subdiv'></div>
    </div>
</sidebar>

<div id='content_div'>
    <h1 id='HA1'>Init</h1>
    
    <span id='patest'></span>
    <id id='react_test0'></id>
    <id id='react_test'></id>

    <!-- <div class="slidecontainer">
        <input type="range" min="1" max="100" value="50" 
        class="slider" id="myRange">
    </div> -->
</div>

<script type='text/babel'>
function update_react(){
    if (pa_interface.data === null) return;
    update_sidebar_sinks_inputs()
    const indexes = pa_interface.data['sink input indexes'];
    var si = pa_interface.data['sink inputs'];
    // write_console(indexes);
    var sactive = pa_interface.data['active sink'];
    var sk = pa_interface.data['sinks'][sactive];

    ReactDOM.render(
        <div className='sink-div'>
            <span>Sink: {sactive}</span>
            <br/>
            <span>Volume: {sk['volume']['front-left']['percent']}</span>
        </div>,
        document.getElementById('react_test0')
    );

    const listItems = indexes.map((i) =>
        <div key={i} className='sink-input-div'>
            <li>Index: {si[i]['index']}</li>
            <li>Name: {a_or_b(si[i]['app name'], si[i]['media name'])}</li>
            <li>Volume: {si[i]['volume']}</li>
            <li>Sink: {si[i]['sink']}</li>
        </div>
    );
    ReactDOM.render(
        listItems,
        document.getElementById('react_test')
    );
}

function update_sidebar_sinks_inputs(){
    // Render sink subdiv
    var indexes = pa_interface.data['sink indexes'];
    var sactive = pa_interface.data['active sink'];
    var sinks = pa_interface.data['sinks'];
    const listItems = indexes.map((i) =>
        <button key={i} className='w3-button spagui-bar-subitem'>
            {get_sink_name(sinks[i])}
        </button>
    );
    ReactDOM.render(
        listItems,
        document.getElementById('sidebar-sink-subdiv')
    );

    // Render sink input subdiv
    indexes = pa_interface.data['sink input indexes'];
    var inputs = pa_interface.data['sink inputs'];
    const listItems2 = indexes.map((i) =>
        <button key={i} className='w3-button spagui-bar-subitem'>
            {a_or_b(inputs[i]['app name'], inputs[i]['media name'])}
        </button>
    );
    ReactDOM.render(
        listItems2,
        document.getElementById('sidebar-input-subdiv')
    );
}
</script>
</body>
</html>